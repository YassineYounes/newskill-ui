<section class="course-content">
  <div class="container">
    <div class="row">
      <div class="col-lg-9">
        <!-- Filter -->
        <div class="showing-list">
          <div class="row">
            <div class="col-lg-6">
              <div class="d-flex align-items-center">
                <div class="view-icons">
                  <a (click)="displayType = 'grid'" class="grid-view" [ngClass]="displayType === 'grid' ? 'active' : ''"><i class="feather icon-grid"></i></a>
                  <a (click)="displayType = 'list'" class="list-view" [ngClass]="displayType === 'list' ? 'active' : ''"><i class="feather icon-list"></i></a>
                </div>
                <div class="show-result">
                  <h4>Showing {{ dataSource && dataSource.filteredData.length < 9 ? dataSource.filteredData.length : 9 }} of {{ dataSource ? dataSource.filteredData.length : '' }} results</h4>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="show-filter add-course-info mat-style">
                <form action="#">
                  <div class="row gx-2 align-items-center">
                    <div class="col-md-6 col-item">
                      <div class=" search-group">
                        <i class="feather icon-search"></i>
                        <input [(ngModel)]="searchDataValue"
                               (ngModelChange)="searchData(searchDataValue)"
                               class="form-control"
                               name="one"
                               placeholder="Search our courses" type="text">
                      </div>
                    </div>
                    <div class="col-md-6 col-lg-6 col-item">
                      <div class="input-block select-form mb-0">
                        <mat-form-field class="custom-mat-select">
                          <mat-label>Sort By</mat-label>
                          <mat-select [(value)]="selectedSort" (selectionChange)="changeSort()">
                            <mat-option value="popular">Most popular</mat-option>
                            <mat-option value="rated">Highest rated</mat-option>
                            <mat-option value="newest">Newest</mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- /Filter -->
        <div class="row" *ngIf="displayType === 'list'">
          @for (course of paginatedCourses; track course) {
            <div class="col-lg-12 col-md-12 d-flex">
              <div class="course-box course-design list-course d-flex list">
                <div class="product">
                  <div class="product-img">
                    <a [routerLink]="routes.page_course_details + '/' + course.id">
                      <img class="img-fluid" alt="" [src]="environment.courseThumbnailsUrl + course.thumbnail">
                    </a>
                  </div>
                  <div class="product-content">
                    <div class="head-course-title">
                      <h3 class="title">
                        <a [routerLink]="routes.page_course_details + '/' + course.id">{{ course.title }}</a></h3>
                      <div class="all-btn all-category d-flex align-items-center">
                        <!--                        <a [routerLink]="routes.page_checkout" class="btn btn-primary">{{ course.content2 }}</a>-->
                        <a *ngIf="!course.isFree" [routerLink]="routes.page_checkout" class="btn btn-primary">{{ course.price | tndCurrency }}</a>
                        <a *ngIf="course.isFree" [routerLink]="routes.page_course_details + '/' + course.id" class="btn btn-primary">FREE</a>
                      </div>
                    </div>
                    <div class="course-info border-bottom-0 pb-0 d-flex align-items-center">
                      <div class="rating-img d-flex align-items-center">
                        <img [src]="'assets/img/icon/icon-01.svg'" alt="">
                        <p>{{ course.numberOfLessons }} Lessons</p>
                      </div>
                      <div class="course-view d-flex align-items-center">
                        <img [src]="'assets/img/icon/icon-02.svg'" alt="">
                        <p>{{ course.courseLength | durationFormat }}</p>
                      </div>
                      <div class="course-view d-flex align-items-center">
                        <img [src]="'assets/img/icon/chart.svg'" alt="">
                        <p>Level: <span>{{ course.level }}</span></p>
                      </div>
                    </div>
                    <app-star-rating [rating]="course.rating" [content]="course.rating + ' (' + course.reviewsCount + ')'"></app-star-rating>
                    <div class="course-group d-flex mb-0">
                      <div class="course-group-img d-flex">
                        <a [routerLink]="routes.instructor_instructor_profile"><img [src]="environment.courseThumbnailsUrl + course.thumbnail" alt=""
                                                                                    class="img-fluid"></a>
                        <div class="course-name">
                          <h4>
                            <a [routerLink]="routes.instructor_instructor_profile">{{ course.instructor?.fullName }}</a>
                          </h4>
                          <p>{{ course.instructor?.title }}</p>
                        </div>
                      </div>
                      <div class="course-share d-flex align-items-center justify-content-center">
                        <a href="javascript:void(0)" (click)="addCourseToWishlist(course)"><i class="fa-heart" [ngClass]="course.inWishList ? 'fa-solid' : 'fa-regular'"></i></a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
        <div class="row" *ngIf="displayType === 'grid'">
          @for (course of paginatedCourses; track course) {
            <div class="col-lg-4 col-md-6 d-flex">
              <div class="course-box course-design d-flex grid">
                <div class="product">
                  <div class="product-img">
                    <a [routerLink]="routes.page_course_details + '/' + course.id">
                      <img class="img-fluid" alt="" [src]="environment.courseThumbnailsUrl + course.thumbnail">
                    </a>
                  </div>
                  <div class="product-content">
                    <div class="course-group d-flex">
                      <div class="course-group-img d-flex">
                        <a [routerLink]="routes.instructor_instructor_profile">
                          <img [src]="environment.courseThumbnailsUrl + course.thumbnail" alt="" class="img-fluid">
                        </a>
                        <div class="course-name">
                          <h4>
                            <a [routerLink]="routes.instructor_instructor_profile">{{ course.instructor?.fullName }}</a>
                          </h4>
                          <p>{{ course.instructor?.title }}</p>
                        </div>
                      </div>
                      <div class="course-share d-flex align-items-center justify-content-center">
                        <a href="javascript:void(0)"><i class="fa-heart" [ngClass]="course.inWishList ? 'fa-solid' : 'fa-regular'"></i></a>
                      </div>
                    </div>
                    <h3 class="title">
                      <a [routerLink]="routes.page_course_details + '/' + course.id" class="multiline-ellipsis">{{ course.title }}</a>
                    </h3>
                    <div class="course-info d-flex align-items-center">
                      <div class="rating-img d-flex align-items-center">
                        <img [src]="'assets/img/icon/icon-01.svg'" alt="">
                        <p>{{ course.numberOfLessons }} Lessons</p>
                      </div>
                      <div class="course-view d-flex align-items-center">
                        <img [src]="'assets/img/icon/icon-02.svg'" alt="">
                        <p>{{ course.courseLength | durationFormat }}</p>
                      </div>
                    </div>
                    <app-star-rating [rating]="course.rating" [content]="course.rating + ' (' + course.reviewsCount + ')'"></app-star-rating>
                    <div class="all-btn all-category d-flex align-items-center">
                      <a *ngIf="!course.isFree" [routerLink]="routes.page_checkout" class="btn btn-primary">{{ course.price | tndCurrency }}</a>
                      <a *ngIf="course.isFree" [routerLink]="routes.page_course_details + '/' + course.id" class="btn btn-primary">FREE</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
        <!-- Pagination Controls -->
        <div class="row">
          <div class="col-md-12">
            <ul class="pagination lms-page">
              <!-- Previous Button -->
              <li class="page-item prev" [class.disabled]="currentPage === 1">
                <a class="page-link" href="javascript:void(0)" (click)="prevPage()">
                  <i class="fas fa-angle-left"></i>
                </a>
              </li>

              <!-- Page Numbers -->
              <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index"
                  [class.active]="currentPage === i + 1">
                <a class="page-link" href="javascript:void(0)" (click)="changePage(i + 1)">
                  {{ i + 1 }}
                </a>
              </li>

              <!-- Next Button -->
              <li class="page-item next" [class.disabled]="currentPage === totalPages">
                <a class="page-link" href="javascript:void(0)" (click)="nextPage()">
                  <i class="fas fa-angle-right"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-lg-3 theiaStickySidebar">
        <div class="stickybar">
          <div class="filter-clear">
            <div class="clear-filter d-flex align-items-center">
              <h4><i class="feather icon-filter"></i>Filters</h4>
              <div class="clear-text">
                <p style="cursor: pointer" (click)="clearFilter()">CLEAR</p>
              </div>
            </div>
            <!-- Search Filter -->
            <div class="card search-filter categories-filter-blk">
              <div class="card-body">
                <div class="filter-widget mb-0">
                  <div class="categories-head d-flex align-items-center">
                    <h4>Course categories</h4>
                  </div>
                  <div class="form-check" *ngFor="let category of categoriesList">
                    <label class="form-check-label">
                      <input
                          class="form-check-input input-box"
                          name="select_specialist"
                          type="checkbox"
                          [value]="category.name"
                          [checked]="category.name && selectedCategories.includes(category.name)"
                          (change)="onCategoryChange($event, category.name)"/>
                      {{ category.name }} ({{ category.coursesCount }})
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <!-- /Search Filter -->
            <!-- Search Filter -->
            <div class="card search-filter">
              <div class="card-body">
                <div class="filter-widget mb-0">
                  <div class="categories-head d-flex align-items-center">
                    <h4>Instructors</h4>
                  </div>
                  <div class="form-check" *ngFor="let instructor of instructorList">
                    <label class="form-check-label">
                      <input
                          class="form-check-input input-box"
                          name="select_instructor"
                          type="checkbox"
                          [value]="instructor.id"
                          [checked]="instructor.id && selectedInstructors.includes(instructor.id)"
                          (change)="onInstructorChange($event, instructor.id)"/>
                      {{ instructor.fullName }} ({{ instructor.coursesCount }})
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <!-- /Search Filter -->
            <!-- Search Filter -->
            <div class="card search-filter ">
              <div class="card-body">
                <div class="filter-widget mb-0">
                  <div class="categories-head d-flex align-items-center">
                    <h4>Price</h4>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input radio-box" name="select_specialist" type="checkbox" [(ngModel)]="selectedFreeFilter" (change)="applyFilters()">
                      Free ({{ freeCourses.length }})
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input radio-box" name="select_specialist" type="checkbox" [(ngModel)]="selectedPayedFilter" (change)="applyFilters()"/>
                      Paid ({{ payedCourses.length }})
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <!-- /Search Filter -->
            <!-- Latest Posts -->
            <div class="card post-widget" *ngIf="latestCourses">
              <div class="card-body">
                <div class="latest-head">
                  <h4 class="card-title">Latest Courses</h4>
                </div>
                <ul class="latest-posts">
                  @for (course of latestCourses; track course) {
                    <li>
                      <div class="post-thumb">
                        <a [routerLink]="routes.page_course_details + '/' + course.id">
                          <img class="img-fluid latest-courses-images" [src]="environment.courseThumbnailsUrl + course.thumbnail" alt="">
                        </a>
                      </div>
                      <div class="post-info" [ngClass]="{'free-color': course.isFree }">
                        <h4>
                          <a [routerLink]="routes.page_course_details + '/' + course.id">{{ course.title }}</a>
                        </h4>
                        <p *ngIf="!course.isFree">{{ course.price | tndCurrency }}</p>
                        <p *ngIf="course.isFree">FREE</p>
                      </div>
                    </li>
                  }
                </ul>
              </div>
            </div>
            <!-- /Latest Posts -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- /Course -->
